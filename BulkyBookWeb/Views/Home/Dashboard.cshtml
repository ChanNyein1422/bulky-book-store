@{
    var result = User.Identity.IsAuthenticated.ToString();
    var _name = "Admin";
    if (result == "True")
    {
        _name = User.Claims.ToArray()[BulkyBookWeb.AuthServices.Auth.AuthDataIndex.Name].Value;
    }

}
<p class="h3 fw-bold">Dashboard</p>
<p class="h4"> Welcome, @_name!</p>

<div class="row">
    <div class="col-sm-6 w-50 text-center">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Total Users</h5>
                <p class="card-text">12</p>
                <a class="btn btn-primary" asp-controller="User" asp-action="UserView">View Details</a>
            </div>
        </div>
    </div>
    <div class="col-sm-6 w-50 text-center">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Total Books Uploaded</h5>
                <p class="card-text">23</p>
                <a class="btn btn-primary" asp-controller="Book" asp-action="Index">View Details</a>
            </div>
        </div>
    </div>
</div>

<p class="h4 mt-3"> User Orders</p>

<div id="loading">
    <div class="spinner-border" role="status"></div>
    <span class="h3 ms-3"> Loading Orders. Please Wait....</span>
</div>
<div id="OrderView"></div>

<div class="modal fade" id="viewOrderDetail" tabindex="-1" aria-labelledby="viewOrderDetailLabel" aria-hidden="true">
    <div class="modal-dialog">
    
            <div id="formholder"></div>
     

    </div>
</div>
@section scripts{
    <script>

        $(function () {
            getOrders();
        });
        function getOrders() {
            $.ajax({
                cache: false,
                url: '@Url.Action("_AdminOrderView","Order")',
                beforeSend: function () {

                },
                success: function (response) {
                    $('#loading').empty();
                    $('#OrderView').empty().append(response);
                },
                complete: function () {

                }
            });
        }
        //function view_order_detail(orderid) {
        //    $.ajax({
        //        cache: false,
        //        url: '@Url.Action("_AdminDetailView","Order")',
        //        data: { id: orderid },
        //        beforesend: function () {

        //        },
        //        success: function (response) {
        //            $('#order_detail_' + orderid).toggle();

        //            $('#order_detail_' + orderid).empty().append(response);
        //        },
        //        complete: function () {

        //        }
        //    });
        // }

        function load_detail_form(id) {
            console.log(id);
            popup_modalform(id, '#viewOrderDetail', '#formholder', '@Url.Action("_AdminDetailView","Order")');
        }

        function popup_modalform(id, modal, formholder, url) {
            $.ajax({
                cache: false,
                url: url,
                data: { id: id },
                beforeSend: function () {
                    showmodal(modal);
                },
                success: function (result) {
                    $(formholder).empty().append(result);        
                },
                complete: function () {
                }
            });
        }
      

        function showmodal(div) {
            $(div).modal('show');
        }

        function hidemodal() {
            $('#viewOrderDetail').modal('hide');
        }
    </script>
}